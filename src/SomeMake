$(info The compilation root directory is: $(ROOT_DIR))                          
$(info The name of the shared library to be created is: $(SHLIB))               

CXX_STD = CXX11
PKG_CPPFLAGS= -Dlibcaf_core_shared_EXPORTS -Wall -pedantic $(SHLIB_OPENMP_CXXFLAGS) -fPIC -O3 -g -fPIC -I../inst -I../inst/include
PKG_LIBS=-L../inst -lcaf_main
LIBS=-L./ -L../inst

DME=./dichotomous/estimation
DMM=./dichotomous/model
DMT=./dichotomous/type

PME=./polytomous/estimation
PMM=./polytomous/model
PMT=./polytomous/type

PTEST=./test
PUTIL=./util

# SOURCES
## DME
DMESOURCES=estep.cpp estimation.cpp mstep.cpp
## DMM
DMMSOURCES=model.cpp
## DMT
DMTSOURCES=estimationdata.cpp
## PME
PMESOURCES=estep.cpp estimation.cpp mstep.cpp
## PMM
PMMSOURCES=model.cpp
## PMT
PMTSOURCES=estimationdata.cpp
## PUTIL
UTILSOURCES=initial_values.cpp quadraturepoints.cpp ramsay.cpp

SOURCES= lrpp.cpp RcppExports.cpp
OBJECTS= $(SOURCES:.cpp=.o)

SOURCES_CAF= $(SOURCES) $(addprefix $(DME),$(DMESOURCES)) $(addprefix $(DMM),$(DMMSOURCES)) $(addprefix $(DMT),$(DMTSOURCES)) $(addprefix $(PME),$(PMESOURCES)) $(addprefix $(PMM),$(DMMSOURCES)) $(addprefix $(PMT),$(PMTSOURCES)) $(addprefix $(PUTIL),$(UTILSOURCES)) $(addprefix $(PTEST))

OBJECTS_CAF = $(SOURCES_CAF:.cpp=.o)
 
all: $(SHLIB) ../inst/libcaf_main.a

$(SHLIB): $(OBJECTS) ../inst/libcaf_main.a 

../inst/libcaf_main.a: $(OBJECTS_CAF)
ar -rvs ../inst/libcaf_main.a $(OBJECTS_CAF)
